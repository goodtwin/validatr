/*! Validatr - v0.5.1 - 2013-05-17
* http://jaymorrow.github.com/validatr/
* Copyright (c) 2013 Jay Morrow; Licensed MIT */
(function(t,e,a,r){"use strict";function i(t,e){if(this.el=t,this.$el=a(t),!this.$el.length||!this.$el.is("form"))throw Error("validatr needs a form to work.");this.isSubmit=!1,this.firstError=!1,this.options=a.extend({},a.fn.validatr.defaultOptions,e),this.template=function(t){var e=a(t.template).addClass("validatr-message");return t.theme.length?e.addClass(k[t.theme]||t.theme):e.css(E),e[0].outerHTML}(this.options),this.option=function(t,e){return arguments.length?e===r?this.options[t]===r?null:this.options[t]:(this.options[t]=e,r):a.extend({},this.options)},this.formElements=this.getElements(this.el).on("valid.validatr",a.proxy(h,this)).on("invalid.validatr",a.proxy(f,this)),this.el.noValidate=!0,this.$el.on("submit.validatr",a.proxy(m,this)),this.$el.on("reset.validatr",a.proxy(c,this))}function n(){this.formElements.on({"focus.validatrelement":o,"blur.validatrelement":l}),a("input[type=radio], input[type=checkbox]").on("click.validatrelement",function(t){u(t.target)})}function s(){this.formElements.off(".validatrelement")}function o(t){var e=t.target,r=a(e);"select"===e.nodeName.toLowerCase()&&r.on("change.validatrinput",function(){setTimeout(function(){u(e)},1)}),r.on({"blur.validatrinput":function(){u(e)},"keyup.validatrinput":function(t){e.value.length&&-1===a.inArray(t.keyCode,x)&&u(e)}})}function l(t){a(t.target).off(".validatrinput")}function u(t){if("radio"===t.type){var e=a(t).closest("form").find("[name="+t.name+"]").filter("[required]");e.length&&(t=e[0])}var r=a(t),i=w.notInput.test(t.nodeName)?t.nodeName.toLowerCase():t.getAttribute("type"),n=v.attributes.required?t.required:a(t).is("[required]"),s={valid:!0,message:""};if(v.inputtypes[i]?(s.valid=t.validity.valid,s.message=t.validationMessage):(n&&(s=y.required(t)),s.valid&&t.value.length&&!w.boxes.test(i)&&(t.pattern&&(i="pattern"),y[i]&&(s=y[i](t)))),s.valid)for(var o in b)if(b.hasOwnProperty(o)&&r.is("[data-"+o+"]")&&(s=b[o](t),!s.valid))break;return s.valid?(r.trigger("valid"),!0):(a.data(t,"validationMessage",s.message),r.trigger("invalid"),!1)}function d(t){var e=!0;return t.each(function(t,a){u(a)||(e=!1)}),e}function m(){this.isSubmit=!0,c.call(this);var t=d(this.formElements);return t?this.options.valid.call(this.el,this.el):(n.call(this),this.isSubmit=!1,t)}function c(){s.call(this),this.firstError=!1,this.formElements.next(".validatr-message").remove()}function f(t){if(!A){t.preventDefault();var e=t.target,i=a(e),n=this.options,s=e.getAttribute("data-message")||a.data(e,"validationMessage"),o=a(this.template.replace("{{message}}",s));return this.isSubmit&&!this.firstError?(this.firstError=i.after(o),n.position.call(this,o,i),r):((!this.isSubmit||n.showall)&&(h(t),i.after(o),n.position.call(this,o,i)),r)}}function h(t){A||a(t.target).next(".validatr-message").remove()}function p(t,e){t.css("position","absolute");var a=e.offset(),r=e[0].getAttribute("data-location")||this.options.location;w.topbottom.test(r)?(t.offset({left:a.left}),"top"===r&&t.offset({top:a.top-t.outerHeight()-2}),"bottom"===r&&t.offset({top:a.top+t.outerHeight()})):w.leftright.test(r)&&(t.offset({top:a.top+e.outerHeight()/2-t.outerHeight()/2}),"left"===r&&t.offset({left:a.left-t.outerWidth()-2}),"right"===r&&t.offset({left:a.left+e.outerWidth()+2}))}var v=function(){var t,a={},i=e.documentElement,n=e.createElement("input"),s=e.createElement("select"),o=e.createElement("textarea"),l=":)",u={},d={};return a.attributes=function(t){for(var e=0,a=t.length;a>e;e++)d[t[e]]=!!(t[e]in n);return d}("max min multiple pattern required step".split(" ")),a.inputtypes=function(t){for(var a,s,o,d=0,m=t.length;m>d;d++)n.setAttribute("type",s=t[d]),a="text"!==n.type,a&&(n.value=l,n.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(s)&&n.style.WebkitAppearance!==r?(i.appendChild(n),o=e.defaultView,a=o.getComputedStyle&&"textfield"!==o.getComputedStyle(n,null).WebkitAppearance&&0!==n.offsetHeight,i.removeChild(n)):/^(search|tel)$/.test(s)||(a=/^(url|email)$/.test(s)?n.checkValidity&&n.checkValidity()===!1:n.value!==l)),u[t[d]]=!!a;return u}("search tel url email datetime date month week time datetime-local number range color".split(" ")),function(r){for(var i=0,s=r.length;s>i;i++){t=n;try{t.setAttribute("type",r[i])}catch(o){t=e.createElement('<input type="'+r[i]+'">')}t.style.cssText="position:absolute;visibility:hidden;",a.inputtypes[r[i]]=!!t.checkValidity}}("text password radio checkbox".split(" ")),a.inputtypes.select=!!s.checkValidity,a.inputtypes.textarea=!!o.checkValidity,n=null,t=null,s=null,o=null,a}(),g=function(){function t(t){return t.substr(0,1).toUpperCase()+t.substr(1)}function e(t){return 10>t?"0"+t:t}function i(t,e){for(var a=-1,r=t?t.length:0;r>++a;)if(t[a]===e)return a;return-1}function n(t){switch(t){case"d":case"w":case"m":return h;case"dd":case"ww":case"mm":case"yy":return p;case"M":return w;case"MM":return b;case"yyyy":return v}}function s(t,e,a){if(e!==r)switch(t){case"d":case"dd":a[2]=~~e;break;case"w":case"ww":a[3]=~~e;break;case"m":case"mm":a[1]=~~e-1;break;case"M":a[1]=i(k,e.toLowerCase());break;case"MM":a[1]=i(x,e.toLowerCase());break;case"yy":a[0]=~~("20"+e);break;case"yyyy":a[0]=~~e}}function o(t){var e=new Date(t.getFullYear(),0,1,0,0,0);return Math.ceil(((t-e)/864e5+e.getDay()+1)/7)}function l(t){var e=u(t[0]),r=6048e5*(t[3]-1),i=e.getTime()+r-864e5*(e.getDay()-a.fn.validatr.defaultOptions.weekStart),n=new Date(i);return n.setHours(0),n}function u(t){var e=new Date(t,0,1,0,0,0),r=a.fn.validatr.defaultOptions.yearStart-e.getDay()+e.getDate();return e.setDate(r),e}function d(t){var e=0,a=[],r=!1;for(e;7>e;e+=1){if(r="number"==typeof t[e],!r&&2>e)return!1;a[e]=r?t[e]:2===e?1:0}return new Date(a[0],a[1],a[2],a[3],a[4],a[5],a[6])}function m(t,e){var a,i=e.match(f)||[],o=[],u=i.length,m=0;if(!u)throw Error("Ivalid date format.");for(m;u>m;m+=1)a=(n(i[m]).exec(t)||[])[0],a&&(t=t.slice(t.indexOf(a)+a.length),s(i[m],a,o));return/w?w/.test(e)?l(o):o.length&&o.length===u?d(o):r}function c(t,e){if(t===!1)return!1;e===r&&(e="yyyy-mm-dd");var a=e.match(f)||[],i=a.length,n=0;if(!i)throw Error("Ivalid date format.");for(n;i>n;n+=1)E[a[n]]&&(e=e.replace(a[n],E[a[n]].call(t)));return e}var f=/(d?d|w?w|m?m|(?:yy)?yy|M?M)/g,h=/\d{1,2}/,p=/\d{2}/,v=/\d{4}/,g="January|February|March|April|May|June|July|August|September|October|November|December",y="Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec",b=RegExp(g,"i"),w=RegExp(y,"i"),x=g.toLowerCase().split("|"),k=y.toLowerCase().split("|"),E={d:function(){return this.getDate()},dd:function(){return e(this.getDate())},w:function(){return o(this)},ww:function(){return e(o(this))},m:function(){return this.getMonth()+1},mm:function(){return e(this.getMonth()+1)},yy:function(){return(""+this.getFullYear()).substr(2)},yyyy:function(){return this.getFullYear()},M:function(){return t(k[this.getMonth()])},MM:function(){return t(x[this.getMonth()])}};return{date:m,isoDate:function(t){return m(t,"yyyy-mm-dd")},toString:c}}(),y=function(){var t={color:/^#[0-9A-F]{6}$/i,email:/^[a-zA-Z0-9.!#$%&â€™*+\/=?\^_`{|}~\-]+@[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]+)*$/,number:/^-?\d*\.?\d*$/,url:/^\s*https?:\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?\s*$/},e={boxes:/checkbox|radio/i,spaces:/,\s*/},i=function(t,e,r,i){var n=!0,s=a.validatr.messages.range.base;return t!==!1&&(i!==!1&&(n="any"===i?!0:0===(t-e)%i,s=a.validatr.messages.range.invalid),n&&(e!==!1&&r!==!1?(n=t>=e&&r>=t,s=a.validatr.messages.range.overUnder):e!==!1?(n=t>=e,s=a.validatr.messages.range.overflow):r!==!1&&(n=r>=t,s=a.validatr.messages.range.underflow))),{valid:t!==!1&&n,message:s}},n=function(t,e){return e+="Format",t.getAttribute("data-format")||a.data(t.form,"validatr").options[e]||a.fn.validatr.defaultOptions[e]},s=function(t,e,a,r){return t=t.replace("{{type}}",e),a&&(t=t.replace("{{min}}",a)),r&&(t=t.replace("{{max}}",r)),t};return{checkbox:function(t){return{valid:t.checked,message:a.validatr.messages.checkbox}},color:function(e){return{valid:t.color.test(e.value),message:a.validatr.messages.color}},date:function(t){var e=a(t),r=n(t,"date"),o=g.date(t.value,r)||!1,l=e.attr("min")?g.isoDate(e.attr("min")):!1,u=e.attr("max")?g.isoDate(e.attr("max")):!1,d=!1,m=i(o,l,u,d);return m.valid||(m.message=s(m.message,"date",g.toString(l,r),g.toString(u,r))),m},email:function(i){var n=!0,s=a.validatr.messages.email.single,o=v.attributes.multiple?i.multiple:a(i).is("[multiple]");if(o){var l=i.value.split(e.spaces);a.each(l,function(e,i){return t.email.test(i)?r:(n=!1,s=a.validatr.messages.email.multiple,r)})}else n=t.email.test(i.value);return{valid:n,message:s}},month:function(t){var e=a(t),r=n(t,"month"),o=g.date(t.value,r)||!1,l=e.attr("min")?g.isoDate(e.attr("min")+"01"):!1,u=e.attr("max")?g.isoDate(e.attr("max")+"01"):!1,d=!1,m=i(o,l,u,d);return m.valid||(m.message=s(m.message,"month",g.toString(l,r),g.toString(u,r))),m},number:function(e){var a,r=e.value.replace(",",""),n=(t.number.test(r)?parseFloat(r):!1,t.number.test(e.getAttribute("min"))?parseFloat(e.getAttribute("min")):!1),o=t.number.test(e.getAttribute("max"))?parseFloat(e.getAttribute("max")):!1,l=t.number.test(e.getAttribute("step"))?parseFloat(e.getAttribute("step")):"any"===e.getAttribute("step")?"any":!1;return(l===!1||0>=l)&&(l=1),a=i(r,n,o,l,"number"),a.valid||(a.message=s(a.message,"number",n,o)),a},pattern:function(t){return{valid:RegExp(t.getAttribute("pattern")).test(t.value),message:a.validatr.messages.pattern}},radio:function(t){return{valid:a(t).closest("form").find("[name="+t.name+"]").is(":checked"),message:a.validatr.messages.radio}},range:function(t){return this.number(t)},required:function(t){return e.boxes.test(t.type)?this[t.type](t):{valid:!!t.value.length,message:"select"===t.nodeName.toLowerCase()?a.validatr.messages.select:a.validatr.messages.required}},url:function(e){return{valid:t.url.test(e.value),message:a.validatr.messages.url}}}}(),b=function(){function t(t){if("text"!==t.type)throw Error("element must have a type of text");var e=t.getAttribute("data-as");return y[e]?y[e](t):r}function i(t){var r=t.getAttribute("data-match"),i=e.getElementById(r)||e.getElementsByName(r)[0];return i?(a(i).off("valid.validatrinput").on("valid.validatrinput",function(){t.value===i.value&&u(t)}),{valid:t.value===i.value,message:"'"+t.name+"' does not equal '"+i.name+"'"}):{valid:!1,message:"'"+r+"' can not be found"}}return{as:t,match:i}}(),w={boxes:/checkbox|radio/i,leftright:/left|right/i,notInput:/select|textarea/i,topbottom:/top|bottom/i},x=[16,17,18,19,20,33,34,35,36,37,39],k={bootstrap:"alert alert-error",jqueryui:"ui-state-error ui-corner-all"},E={color:"#f0444d",backgroundColor:"#ffcbcb",border:"1px solid #e4a6af",padding:"2px 6px",borderRadius:"2px"},A=!1,M=function(){};M.prototype={addTest:function(t){var e="string"!=typeof t,r=Array.prototype.slice.call(arguments,1)[0];if(e)a.extend(b,t);else{if(!r)throw Error("You must include a callback function");b[t]=r}},getElements:function(t){if(this.formElements)return this.formElements;var e=a(t).map(function(){return a.makeArray(this.elements)}).not("fieldset, button, input[type=submit], input[type=button], input[type=reset]");return t.id&&(e=e.add(a('[form="'+t.id+'"]'))),e},validateElement:function(t){if(!t)throw Error("method requires an element");A=!0;var e=u(t[0]||t);return A=!1,e},validateForm:function(t){var e,a=this.el||(t instanceof jQuery?t[0]:t);if("form"!==a.nodeName.toLowerCase())throw Error("you must pass a form to this method");return A=!0,e=d(this.formElements||this.getElements(a)),A=!1,e}},a.fn.validatr=function(t){var e,n="string"==typeof t,s=Array.prototype.slice.call(arguments,1),o=this;if(n)this.each(function(){var i;if(e=a.data(this,"validatr"),!e)throw Error("cannot call methods on validatr prior to initialization; attempted to call method '"+t+"'");if(!a.isFunction(e[t]))throw Error("no such method '"+t+"' for validatr instance");return i=e[t].apply(e,s),i!==e&&i!==r?(o=i&&i.jquery?o.pushStack(i.get()):i,!1):r});else{var l;this.each(function(){e=a.data(this,"validatr"),e||(l=new M,i.call(l,this,t||{}),a.data(this,"validatr",l))})}return o},a.fn.validatr.defaultOptions={dateFormat:"yyyy-mm-d",location:"right",monthFormat:"yyyy-mm",position:p,showall:!1,template:"<div>{{message}}</div>",theme:"",valid:a.noop,weekFormat:"yyyy-Www",weekStart:0,yearStart:6},a.validatr=new M,a.validatr.messages={checkbox:"Please check this box if you want to proceed.",color:"Please enter a color in the format #xxxxxx",email:{single:"Please enter an email address.",multiple:"Please enter a comma separated list of email addresses."},pattern:"Please match the requested format.",radio:"Please select one of these options.",range:{base:"Please enter a {{type}}",overflow:"Please enter a {{type}} greater than or equal to {{min}}.",overUnder:"Please enter a {{type}} greater than or equal to {{min}}<br> and less than or equal to {{max}}.",invalid:"Invalid {{type}}",underflow:"Please enter a {{type}} less than or equal to {{max}}."},required:"Please fill out this field.",select:"Please select an item in the list.",time:"Please enter a time in the format hh:mm:ss",url:"Please enter a url."},a.validatr.debug=function(){if(!QUnit)throw Error("QUnit is required for debugging");this.Support=v,this.Tests=y,this.CustomTests=b,this.Format=g},a.expr[":"].validatr=function(t){return!!a.data(t,"validatr")}})(this,this.document,jQuery);